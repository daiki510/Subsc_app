<table class="table table-hover mt-3">
  <tr class="thead-light">
    <th id="icon">アイコン</th>
    <th id="name">名前</th>
    <th id="summary">概要</th>
    <th id="category">カテゴリー</th>
    <th id="count">利用者数</th>
    <th id="status">利用状況</th>
    <th id="addition">追加</th>
    <th id="menu" colspan="3">メニュー</th>
  </tr>

  <% if @subscriptions.blank? %>
    <tr>一致する結果はありません</tr>
  <% end %>

  <% @subscriptions.each do |subscription| %>
    <tr>
      <% if subscription.icon.present? %>
        <td><%= image_tag subscription.icon.thumb.url %></td>
      <% else %>
        <td>No-Icon</td>
      <% end %>
      <td><%= subscription.name %></td>
      <td><%= subscription.summary %></td>
      <%# カテゴリー一覧 %>
      <td>
        <% subscription.categories.each do |category|%>
          <%= link_to category.name, subscriptions_path(category_id: category.id), class: "badge badge-primary py-1 px-2" %>
        <% end %>
      </td>
      <%# 利用者数 %>
      <td class="text-center"><%= subscription.additions.count %></td>
      <%# 利用状況 %>
      <td>
        <% if current_user.already_added?(subscription) %>
          利用中
        <% end %>
      </td>
      <%# 追加or解除ボタン %>
      <td>
        <% if current_user.already_added?(subscription) %>
          <%= button_to '解除', subscription_addition_path(subscription, id: current_user.id), method: :delete, remote: true, class: "btn btn-light" %>
        <% else %>
          <%= button_to '追加', subscription_additions_path(subscription), remote: true, class: "btn btn-secondary" %>
        <% end %>
      </td>
      <td>
        <%= link_to '詳細', subscription_path(subscription.id) ,class: "btn btn-info mr-2" %>
        <% if current_user.admin? %>
          <%= link_to '編集', edit_subscription_path(subscription.id) ,class: "btn btn-success mr-2" %>
          <%= link_to '削除', subscription_path(subscription), method: :delete, remote: true, data: { confirm: '本当に削除してもいいですか?' } ,class: "btn btn-danger delete" %>
        <% end %>
      </td>
    </tr>
  <% end %>
</table>